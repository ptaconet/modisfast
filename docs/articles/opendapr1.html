<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Get started • modisfast</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1. Get started">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modisfast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/opendapr1.html">1. Get started </a>
    </li>
    <li>
      <a href="../articles/opendapr2.html">2. Advanced use of `mf_get_url()`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ptaconet/modisfast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="opendapr1_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="opendapr1_files/jquery-1.12.4/jquery.min.js"></script><link href="opendapr1_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="opendapr1_files/leaflet-1.3.1/leaflet.js"></script><link href="opendapr1_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="opendapr1_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="opendapr1_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="opendapr1_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="opendapr1_files/leaflet-binding-2.0.2/leaflet.js"></script><script src="opendapr1_files/leaflet-providers-1.1.17/leaflet-providers.js"></script><script src="opendapr1_files/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script><link href="opendapr1_files/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="opendapr1_files/HomeButton-0.0.1/home-button.js"></script><script src="opendapr1_files/HomeButton-0.0.1/easy-button-src.min.js"></script><link href="opendapr1_files/PopupTable-0.0.1/popup.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>1. Get started</h1>
                        <h4 class="author">Paul Taconet</h4>
            
            <h4 class="date">2020-02-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ptaconet/modisfast/blob/master/vignettes/opendapr1.Rmd"><code>vignettes/opendapr1.Rmd</code></a></small>
      <div class="hidden name"><code>opendapr1.Rmd</code></div>

    </div>

    
    
<p>In this example we want to download, import and plot over the 3500 km<sup>2</sup> wide region of interest (mapped below) :</p>
<ul>
<li>a 30 days-long time series of land surface temperature from <a href="https://dx.doi.org/10.5067/MODIS/MOD11A1.006">MODIS Terra LST</a> (spatial resolution : 1 km ; temporal resolution : 1 day),</li>
<li>the same 30 days-long times series of precipitations from <a href="https://doi.org/10.5067/GPM/IMERGDF/DAY/06">Global Precipitation Measurement (GPM)</a> (spatial resolution : 1° ; temporal resolution : 1 day)</li>
<li>the same 30 days-long times series of soil moisture from <a href="https://doi.org/10.5067/T90W6VRLCBHI">SMAP Daily</a> (spatial resolution : 9 km ; temporal resolution : 2/3 days)</li>
</ul>
<div id="htmlwidget-a2a6b632db8195507589" style="width:288px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a2a6b632db8195507589">{"x":{"options":{"minZoom":1,"maxZoom":100,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",1,"CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter",2,"CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["OpenStreetMap",3,"OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",4,"Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["OpenTopoMap",5,"OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-5.82,-5.42,-5.41,-5.81,-5.82],"lat":[9.54,9.55,8.84,8.84,9.54]}]]],null,"roi",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":1,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6,"smoothFactor":1,"noClip":false},"<html><head><link rel=\"stylesheet\" type=\"text/css\" href=\"lib/popup/popup.css\"><\/head><body><div class=\"scrollableContainer\"><table class=\"popup scrollable\" id=\"popup\"><tr class='coord'><td><\/td><td><b>Feature ID<\/b><\/td><td align='right'>1&emsp;<\/td><\/tr><tr class='alt'><td>1<\/td><td><b>geom&emsp;<\/b><\/td><td align='right'>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div><\/body><\/html>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":2,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-5.82,8.84,-5.41,9.55,"Zoom to roi","<strong> roi <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"roi",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[8.84,9.55],"lng":[-5.82,-5.41]}},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      //map.on('click', function (e) {\n      //  var txt = document.querySelector('.lnlt').textContent;\n      //  console.log(txt);\n      //  //txt.innerText.focus();\n      //  //txt.select();\n      //  setClipboardText(txt);\n      //});\n\n      function setClipboardText(text){\n      var id = 'mycustom-clipboard-textarea-hidden-id';\n      var existsTextarea = document.getElementById(id);\n\n      if(!existsTextarea){\n      console.log('Creating textarea');\n      var textarea = document.createElement('textarea');\n      textarea.id = id;\n      // Place in top-left corner of screen regardless of scroll position.\n      textarea.style.position = 'fixed';\n      textarea.style.top = 0;\n      textarea.style.left = 0;\n\n      // Ensure it has a small width and height. Setting to 1px / 1em\n      // doesn't work as this gives a negative w/h on some browsers.\n      textarea.style.width = '1px';\n      textarea.style.height = '1px';\n\n      // We don't need padding, reducing the size if it does flash render.\n      textarea.style.padding = 0;\n\n      // Clean up any borders.\n      textarea.style.border = 'none';\n      textarea.style.outline = 'none';\n      textarea.style.boxShadow = 'none';\n\n      // Avoid flash of white box if rendered for any reason.\n      textarea.style.background = 'transparent';\n      document.querySelector('body').appendChild(textarea);\n      console.log('The textarea now exists :)');\n      existsTextarea = document.getElementById(id);\n      }else{\n      console.log('The textarea already exists :3')\n      }\n\n      existsTextarea.value = text;\n      existsTextarea.select();\n\n      try {\n      var status = document.execCommand('copy');\n      if(!status){\n      console.error('Cannot copy text');\n      }else{\n      console.log('The text is now on the clipboard');\n      }\n      } catch (err) {\n      console.log('Unable to copy.');\n      }\n      }\n\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null}]}}</script><div id="check-which-collections-are-available" class="section level2">
<h2 class="hasAnchor">
<a href="#check-which-collections-are-available" class="anchor"></a>Check which collections are available</h2>
<p>Before starting, let’s identify our collections of interest among the collections that are available for download, using the function <code><a href="../reference/mf_list_collections.html">mf_list_collections()</a></code> :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">collections &lt;-<span class="st"> </span>modisfast<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/modisfast/topics/mf_list_collections">mf_list_collections</a></span>()</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(collections))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; 'data.frame':    77 obs. of  26 variables:</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;  $ collection              : chr  "GPM_3IMERGDE.06" "GPM_3IMERGDF.06" "GPM_3IMERGDL.06" "GPM_3IMERGHH.06" ...</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ source                  : chr  "GPM" "GPM" "GPM" "GPM" ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;  $ long_name               : chr  "GPM IMERG Early Precipitation L3 1 day 0.1 degree x 0.1 degree V06" "GPM IMERG Final Precipitation L3 1 day 0.1 degree x 0.1 degree V06" "GPM IMERG Late Precipitation L3 1 day 0.1 degree x 0.1 degree V06" "GPM IMERG Final Precipitation L3 Half Hourly 0.1 degree x 0.1 degree V06" ...</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;  $ nature                  : chr  "Rainfall" "Rainfall" "Rainfall" "Rainfall" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;  $ provider                : chr  "NASA GES DISC" "NASA GES DISC" "NASA GES DISC" "NASA GES DISC" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ url_metadata            : chr  "https://disc.gsfc.nasa.gov/datasets/GPM_3IMERGDE_06/summary" "https://disc.gsfc.nasa.gov/datasets/GPM_3IMERGDF_06/summary" "https://disc.gsfc.nasa.gov/datasets/GPM_3IMERGDL_06/summary" "https://disc.gsfc.nasa.gov/datasets/GPM_3IMERGHH_06/summary" ...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  $ doi                     : chr  "https://doi.org/10.5067/GPM/IMERGDE/DAY/06" "https://doi.org/10.5067/GPM/IMERGDF/DAY/06" "https://doi.org/10.5067/GPM/IMERGDL/DAY/06" "https://doi.org/10.5067/GPM/IMERG/3B-HH/06" ...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ version                 : num  6 6 6 6 6 6 6 6 6 6 ...</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;  $ spatial_resolution_m    : int  10000 10000 10000 10000 10000 10000 10000 500 500 500 ...</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;  $ temporal_resolution     : int  1 1 1 30 30 30 1 365 8 4 ...</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;  $ temporal_resolution_unit: chr  "day" "day" "day" "minute" ...</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;  $ spatial_coverage        : chr  "Global" "Global" "Global" "Global" ...</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt;  $ start_date              : chr  "2000-06-01" "2000-06-01" "2000-06-01" "2000-06-01" ...</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;  $ end_date                : chr  "ongoing" "ongoing" "ongoing" "ongoing" ...</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;  $ indicative_latency_days : int  1 100 1 100 0 1 100 774 12 8 ...</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;  $ url_manual_access       : chr  "https://search.earthdata.nasa.gov/search?q=GPM_3IMERGDE_06" "https://search.earthdata.nasa.gov/search?q=GPM_3IMERGDF_06" "https://search.earthdata.nasa.gov/search?q=GPM_3IMERGDL_06" "https://search.earthdata.nasa.gov/search?q=GPM_3IMERGHH_06" ...</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;  $ status                  : chr  "Implemented" "Implemented" "Implemented" "Implemented" ...</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;  $ login                   : chr  "earthdata" "earthdata" "earthdata" "earthdata" ...</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;  $ url_opendapserver       : chr  "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/" ...</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;  $ url_programmatic_access : chr  "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDE.06/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDL.06/" "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGHH.06/" ...</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;  $ url_opendapexample      : chr  "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDE.06/2000/06/3B-DAY-E.MS.MRG.3IMERG.20000601-S00"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/hyrax/GPM_L3/GPM_3IMERGDF.06/2000/06/3B-DAY.MS.MRG.3IMERG.20000601"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/hyrax/GPM_L3/GPM_3IMERGDL.06/2000/06/3B-DAY-L.MS.MRG.3IMERG.200006"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/hyrax/GPM_L3/GPM_3IMERGHH.06/2000/153/3B-HHR.MS.MRG.3IMERG.2000060"| __truncated__ ...</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt;  $ dim_lon                 : chr  "lon" "lon" "lon" "lon" ...</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt;  $ dim_lat                 : chr  "lat" "lat" "lat" "lat" ...</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;  $ dim_time                : chr  "time" "time" "time" "time" ...</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;  $ dim_proj                : chr  NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;  $ crs                     : chr  "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,3" "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" "+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,4" ...</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>So our collections of interest are :</p>
<ul>
<li><em>MOD11A1.006</em></li>
<li><em>GPM_3IMERGDF.06</em></li>
<li><em>SPL3SMP_E.003</em></li>
</ul>
</div>
<div id="setup-the-region-and-time-range-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#setup-the-region-and-time-range-of-interest" class="anchor"></a>Setup the region and time range of interest</h2>
<p>First we call the useful packages and we define the ROI and the time frame.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(modisfast)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(sf)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(stars)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(raster)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(ncdf4)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(magrittr)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(purrr)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Set ROI and time range of interest</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">roi &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_as_sf">st_as_sf</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">geom=</span><span class="st">"POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"</span>), <span class="dt">wkt=</span><span class="st">"geom"</span>, <span class="dt">crs =</span> <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">time_range &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2017-01-01"</span>,<span class="st">"2017-01-30"</span>))</a></code></pre></div>
</div>
<div id="login-to-eosdis-earthdata" class="section level2">
<h2 class="hasAnchor">
<a href="#login-to-eosdis-earthdata" class="anchor"></a>Login to EOSDIS Earthdata</h2>
<p>And we login to EOSDIS Earthdata with our credentials. To create an account go to : <a href="https://urs.earthdata.nasa.gov/" class="uri">https://urs.earthdata.nasa.gov/</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Login to Earthdata servers with username and password. </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">username &lt;-<span class="st"> "earthdata_un"</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">password &lt;-<span class="st"> "earthdata_pw"</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">log &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mf_login.html">mf_login</a></span>(<span class="dt">credentials =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(username,password), <span class="dt">source =</span> <span class="st">"earthdata"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Checking credentials...</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; Successfull login to earthdata</span></a></code></pre></div>
</div>
<div id="get-url" class="section level2">
<h2 class="hasAnchor">
<a href="#get-url" class="anchor"></a>Get the OPeNDAP URLs of the data to download</h2>
<p>With the function <code><a href="../reference/mf_get_url.html">mf_get_url()</a></code>, we get the https URLs for our collections of interest (<em>MOD11A1.006</em>, <em>GPM_3IMERGDF.06</em> and <em>SPL3SMP_E.003</em>) given our ROI and time frame.</p>
<p><strong>Note on the use of the parameter <code>variables</code> of the function <code><a href="../reference/mf_get_url.html">mf_get_url()</a></code> :</strong></p>
<p>The collections generally contain several variables (sometimes called “dimensions”, or “bands”). As an example, MODIS LST products contain one band for the day temperature (“LST_Day_1km”), one band for the night temperature (“LST_Night_1km”), etc. To get all the variables available for a given collection along with information for each of them (description, etc.), use the function <code><a href="../reference/mf_list_variables.html">mf_list_variables()</a></code>. e.g. :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/headtail">tail</a></span>(<span class="kw"><a href="../reference/mf_list_variables.html">mf_list_variables</a></span>(<span class="st">"MOD11A1.006"</span>))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;             name                                             long_name</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 13 Clear_day_cov                                day clear-sky coverage</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 14 Day_view_angl View zenith angle of daytime Land-surface Temperature</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 15   LST_Day_1km       Daily daytime 1km grid Land-surface Temperature</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 16       Emis_31                                    Band 31 emissivity</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 17       Emis_32                                    Band 32 emissivity</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 18          time                                                  &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;    units                                   indices</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 13  &lt;NA&gt; [time = 6845] [YDim = 1200] [XDim = 1200]</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 14   deg [time = 6845] [YDim = 1200] [XDim = 1200]</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; 15     K [time = 6845] [YDim = 1200] [XDim = 1200]</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 16  &lt;NA&gt; [time = 6845] [YDim = 1200] [XDim = 1200]</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 17  &lt;NA&gt; [time = 6845] [YDim = 1200] [XDim = 1200]</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 18  &lt;NA&gt;                             [time = 6845]</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      all_info</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; 13                                                                           Array of 32 bit Reals [time = 0..6844][YDim = 0..1199][XDim = 0..1199]coordinates: Latitude Longitude\nlong_name: day clear-sky coverage\nday_clear_sky_cov: day_clear_sky_cov data * scale_factor\nscale_factor_err: 0.0000000000000000\nadd_offset_err: 0.0000000000000000\ncalibrated_nt: 5\norig_scale_factor: 0.00050000000000000001\n_FillValue: 0\nvalid_min: 0.0005000000237\nvalid_max: 32.76750183\nNumber_Type_Orig: uint16\ngrid_mapping: MODIS_Grid_Daily_1km_LST_eos_cf_projection</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 14 Array of 32 bit Reals [time = 0..6844][YDim = 0..1199][XDim = 0..1199]coordinates: Latitude Longitude\nlong_name: View zenith angle of daytime Land-surface Temperature\nunits: deg\nView_angle: View_angle data * scale_factor + add_offset\nscale_factor_err: 0.0000000000000000\nadd_offset_err: 0.0000000000000000\ncalibrated_nt: 5\norig_scale_factor: 1.0000000000000000\norig_add_offset: -65.000000000000000\n_FillValue: 255\nvalid_min: -65.00000000\nvalid_max: 65.00000000\nNumber_Type_Orig: uint8\ngrid_mapping: MODIS_Grid_Daily_1km_LST_eos_cf_projection</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 15                                                                          Array of 32 bit Reals [time = 0..6844][YDim = 0..1199][XDim = 0..1199]coordinates: Latitude Longitude\nlong_name: Daily daytime 1km grid Land-surface Temperature\nunits: K\nLST: LST data * scale_factor\nscale_factor_err: 0.0000000000000000\nadd_offset_err: 0.0000000000000000\ncalibrated_nt: 5\norig_scale_factor: 0.020000000000000000\n_FillValue: 0\nvalid_min: 150.0000000\nvalid_max: 1310.699951\nNumber_Type_Orig: uint16\ngrid_mapping: MODIS_Grid_Daily_1km_LST_eos_cf_projection</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 16                                                     Array of 32 bit Reals [time = 0..6844][YDim = 0..1199][XDim = 0..1199]coordinates: Latitude Longitude\nlong_name: Band 31 emissivity\nEmis_31: Emis_31 data * scale_factor + add_offset\nscale_factor_err: 0.0000000000000000\nadd_offset_err: 0.0000000000000000\ncalibrated_nt: 5\norig_scale_factor: 0.0020000000000000000\norig_add_offset: 0.48999999999999999\n_FillValue: 0\nvalid_min: 0.4920000136\nvalid_max: 1.000000000\nNumber_Type_Orig: uint8\ngrid_mapping: MODIS_Grid_Daily_1km_LST_eos_cf_projection</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; 17                                                     Array of 32 bit Reals [time = 0..6844][YDim = 0..1199][XDim = 0..1199]coordinates: Latitude Longitude\nlong_name: Band 32 emissivity\nEmis_32: Emis_32 data * scale_factor + add_offset\nscale_factor_err: 0.0000000000000000\nadd_offset_err: 0.0000000000000000\ncalibrated_nt: 5\norig_scale_factor: 0.0020000000000000000\norig_add_offset: 0.48999999999999999\n_FillValue: 0\nvalid_min: 0.4920000136\nvalid_max: 1.000000000\nNumber_Type_Orig: uint8\ngrid_mapping: MODIS_Grid_Daily_1km_LST_eos_cf_projection</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; 18                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Array of 64 bit Reals [time = 0..6844]units: days since 2000-01-01 00:00</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;     extractable_w_opendapr</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; 13             extractable</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; 14             extractable</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; 15             extractable</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; 16             extractable</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt; 17             extractable</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt; 18 automatically extracted</span></a></code></pre></div>
<p>In <code><a href="../reference/mf_get_url.html">mf_get_url()</a></code>, the parameter <code>variables</code> enables to restrict the data to download to only specific variables. By default it is set to <code>NULL</code>, which means that all the available variables for the specified collection are downloaded. Specifying <code>variables</code> will make the data to download lighter.</p>
<p><strong>End Note</strong></p>
<p>In our example, we specify some variables for each collection.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">## Get the URLs of MODIS Terra LST daily</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">urls_mod11a1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mf_get_url.html">mf_get_url</a></span>(</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">collection =</span> <span class="st">"MOD11A1.006"</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">variables =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"LST_Day_1km"</span>,<span class="st">"LST_Night_1km"</span>,<span class="st">"QC_Day"</span>,<span class="st">"QC_Night"</span>),  <span class="co"># get the variables available with : mf_list_variables("MOD11A1.006") ; or set to NULL (defaults) to download all the variables</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">roi =</span> roi,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">time_range =</span> time_range</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"> )</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; Building the URLs...</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; Note : messages above ('although coordinates are longitude/latitude, st_intersection assumes that they are planar' and 'attribute variables are assumed to be spatially constant throughout all geometries') are not errors</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; OK</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">## Get the URLs of GPM daily</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">urls_gpm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mf_get_url.html">mf_get_url</a></span>(</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  <span class="dt">collection =</span> <span class="st">"GPM_3IMERGDF.06"</span>,</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  <span class="dt">variables =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"precipitationCal"</span>,<span class="st">"precipitationCal_cnt"</span>),  <span class="co"># get the variables available with : mf_list_variables("GPM_L3/GPM_3IMERGDF.06")</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  <span class="dt">roi =</span> roi,</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  <span class="dt">time_range =</span> time_range</a>
<a class="sourceLine" id="cb6-18" data-line-number="18"> )</a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; Building the URLs...</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; OK</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">## Get the URLs of SMAP 3-days</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23">urls_smap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mf_get_url.html">mf_get_url</a></span>(</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">  <span class="dt">collection =</span> <span class="st">"SPL3SMP_E.003"</span>,</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  <span class="dt">variables =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Soil_Moisture_Retrieval_Data_AM_soil_moisture"</span>,<span class="st">"Soil_Moisture_Retrieval_Data_AM_retrieval_qual_flag"</span>,<span class="st">"Soil_Moisture_Retrieval_Data_PM_soil_moisture_pm"</span>,<span class="st">"Soil_Moisture_Retrieval_Data_PM_retrieval_qual_flag_pm"</span>),     <span class="co"># get the variables available with : mf_list_variables("SMAP/SPL3SMP_E.003")</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26">  <span class="dt">roi =</span> roi,</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">  <span class="dt">time_range =</span> time_range</a>
<a class="sourceLine" id="cb6-28" data-line-number="28"> )</a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; Building the URLs...</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; OK</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(urls_mod11a1)</a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/headtail">head</a></span>(urls_mod11a1,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt;   time_start                               name</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; 1 2017-01-01 MOD11A1.006.2017001_2017030.h17v08</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                     url</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; 1 https://opendap.cr.usgs.gov/opendap/hyrax/MOD11A1.006/h17v08.ncml.nc4?MODIS_Grid_Daily_1km_LST_eos_cf_projection,LST_Day_1km[6093:6122][55:140][512:560],LST_Night_1km[6093:6122][55:140][512:560],QC_Day[6093:6122][55:140][512:560],QC_Night[6093:6122][55:140][512:560],time[6093:6122],YDim[55:140],XDim[512:560]</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt;                                             destfile</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; 1 MOD11A1.006/MOD11A1.006.2017001_2017030.h17v08.nc4</span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(urls_gpm)</a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; [1] 30</span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/headtail">head</a></span>(urls_gpm,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt;   time_start                                              name</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; 1 2017-01-01 3B-DAY.MS.MRG.3IMERG.20170101-S000000-E235959.V06</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt; 2 2017-01-02 3B-DAY.MS.MRG.3IMERG.20170102-S000000-E235959.V06</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt; 3 2017-01-03 3B-DAY.MS.MRG.3IMERG.20170103-S000000-E235959.V06</span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt;                                                                                                                                                                                                                                                                   url</span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; 1 https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170101-S000000-E235959.V06.nc4.nc4?precipitationCal[0:0][1742:1746][989:996],precipitationCal_cnt[0:0][1742:1746][989:996],time[0:0],lon[1742:1746],lat[989:996]</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt; 2 https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170102-S000000-E235959.V06.nc4.nc4?precipitationCal[0:0][1742:1746][989:996],precipitationCal_cnt[0:0][1742:1746][989:996],time[0:0],lon[1742:1746],lat[989:996]</span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; 3 https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170103-S000000-E235959.V06.nc4.nc4?precipitationCal[0:0][1742:1746][989:996],precipitationCal_cnt[0:0][1742:1746][989:996],time[0:0],lon[1742:1746],lat[989:996]</span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt;                                                                destfile</span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; 1 GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170101-S000000-E235959.V06.nc4</span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"><span class="co">#&gt; 2 GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170102-S000000-E235959.V06.nc4</span></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="co">#&gt; 3 GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170103-S000000-E235959.V06.nc4</span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"></a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(urls_smap)</a>
<a class="sourceLine" id="cb6-60" data-line-number="60"><span class="co">#&gt; [1] 30</span></a>
<a class="sourceLine" id="cb6-61" data-line-number="61"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/headtail">head</a></span>(urls_smap,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-62" data-line-number="62"><span class="co">#&gt;   time_start                               name</span></a>
<a class="sourceLine" id="cb6-63" data-line-number="63"><span class="co">#&gt; 1 2017-01-01 SMAP_L3_SM_P_E_20170101_R16510_001</span></a>
<a class="sourceLine" id="cb6-64" data-line-number="64"><span class="co">#&gt; 2 2017-01-02 SMAP_L3_SM_P_E_20170102_R16510_001</span></a>
<a class="sourceLine" id="cb6-65" data-line-number="65"><span class="co">#&gt; 3 2017-01-03 SMAP_L3_SM_P_E_20170103_R16510_001</span></a>
<a class="sourceLine" id="cb6-66" data-line-number="66"><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    url</span></a>
<a class="sourceLine" id="cb6-67" data-line-number="67"><span class="co">#&gt; 1 https://n5eil02u.ecs.nsidc.org/opendap/SMAP/SPL3SMP_E.003/2017.01.01/SMAP_L3_SM_P_E_20170101_R16510_001.h5.nc4?Soil_Moisture_Retrieval_Data_AM_soil_moisture[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_retrieval_qual_flag[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_soil_moisture_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_retrieval_qual_flag_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_longitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_latitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_longitude_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_latitude_pm[678:1:688][1866:1:1871]</span></a>
<a class="sourceLine" id="cb6-68" data-line-number="68"><span class="co">#&gt; 2 https://n5eil02u.ecs.nsidc.org/opendap/SMAP/SPL3SMP_E.003/2017.01.02/SMAP_L3_SM_P_E_20170102_R16510_001.h5.nc4?Soil_Moisture_Retrieval_Data_AM_soil_moisture[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_retrieval_qual_flag[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_soil_moisture_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_retrieval_qual_flag_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_longitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_latitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_longitude_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_latitude_pm[678:1:688][1866:1:1871]</span></a>
<a class="sourceLine" id="cb6-69" data-line-number="69"><span class="co">#&gt; 3 https://n5eil02u.ecs.nsidc.org/opendap/SMAP/SPL3SMP_E.003/2017.01.03/SMAP_L3_SM_P_E_20170103_R16510_001.h5.nc4?Soil_Moisture_Retrieval_Data_AM_soil_moisture[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_retrieval_qual_flag[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_soil_moisture_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_retrieval_qual_flag_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_longitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_AM_latitude[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_longitude_pm[678:1:688][1866:1:1871],Soil_Moisture_Retrieval_Data_PM_latitude_pm[678:1:688][1866:1:1871]</span></a>
<a class="sourceLine" id="cb6-70" data-line-number="70"><span class="co">#&gt;                                               destfile</span></a>
<a class="sourceLine" id="cb6-71" data-line-number="71"><span class="co">#&gt; 1 SPL3SMP_E.003/SMAP_L3_SM_P_E_20170101_R16510_001.nc4</span></a>
<a class="sourceLine" id="cb6-72" data-line-number="72"><span class="co">#&gt; 2 SPL3SMP_E.003/SMAP_L3_SM_P_E_20170102_R16510_001.nc4</span></a>
<a class="sourceLine" id="cb6-73" data-line-number="73"><span class="co">#&gt; 3 SPL3SMP_E.003/SMAP_L3_SM_P_E_20170103_R16510_001.nc4</span></a></code></pre></div>
</div>
<div id="download" class="section level2">
<h2 class="hasAnchor">
<a href="#download" class="anchor"></a>Download the data</h2>
<p>Now we download the data with the function <code><a href="../reference/mf_download_data.html">mf_download_data()</a></code>.</p>
<p>Destination file for each dataset is specified in the column <em>destfile</em> of the dataframes <em>urls_mod11a1</em>, <em>urls_gpm</em> and <em>urls_smap</em>. The destination file is specified by default but it can of course be modified.</p>
<p>Setting the argument <code>parallel</code> to <code>TRUE</code> will parallelize - therefore fasten - the download in case their are numerous datasets to download</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">df_to_dl &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(urls_mod11a1,urls_gpm,urls_smap)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">res_dl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mf_download_data.html">mf_download_data</a></span>(df_to_dl,<span class="dt">source=</span><span class="st">"earthdata"</span>,<span class="dt">parallel =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; 61  datasets in total :  61  already downloaded and  0  datasets to download</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; OK</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(res_dl))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 'data.frame':    61 obs. of  7 variables:</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  $ time_start: Date, format: "2017-01-01" "2017-01-01" ...</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  $ name      : chr  "MOD11A1.006.2017001_2017030.h17v08" "3B-DAY.MS.MRG.3IMERG.20170101-S000000-E235959.V06" "3B-DAY.MS.MRG.3IMERG.20170102-S000000-E235959.V06" "3B-DAY.MS.MRG.3IMERG.20170103-S000000-E235959.V06" ...</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  $ url       : chr  "https://opendap.cr.usgs.gov/opendap/hyrax/MOD11A1.006/h17v08.ncml.nc4?MODIS_Grid_Daily_1km_LST_eos_cf_projectio"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170101-S0000"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170102-S0000"| __truncated__ "https://gpm1.gesdisc.eosdis.nasa.gov/opendap/GPM_L3/GPM_3IMERGDF.06/2017/01/3B-DAY.MS.MRG.3IMERG.20170103-S0000"| __truncated__ ...</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  $ destfile  : chr  "MOD11A1.006/MOD11A1.006.2017001_2017030.h17v08.nc4" "GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170101-S000000-E235959.V06.nc4" "GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170102-S000000-E235959.V06.nc4" "GPM_3IMERGDF.06/3B-DAY.MS.MRG.3IMERG.20170103-S000000-E235959.V06.nc4" ...</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  $ fileDl    : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  $ fileSize  : num  287343 34510 34516 34518 34510 ...</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  $ dlStatus  : num  3 3 3 3 3 3 3 3 3 3 ...</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
<div id="import" class="section level2">
<h2 class="hasAnchor">
<a href="#import" class="anchor"></a>Import the data in R</h2>
<p>Importing the data in R goes beyond the scope of this package. However, here we provide some tips and tricks to do the job for further data analysis in R !</p>
<p>Various packages and related classes can be used to read the datacubes downloaded through OPeNDAP (in NetCDF, ascii or json format). If <code>raster</code> is surely the most famous class for raster objects, many packages facilitate the use of spatiotemporal data cubes in formats such as those proposed through modisfast (e.g. NetCDF). For instance, MODIS or VIIRS products can be imported as a <code>stars</code> object from the excellent <a href="https://cran.r-project.org/package=stars"><code>stars</code></a> package for data cubes manipulation. All the data can also be imported as <code>ncdf4</code> objects using e.g. the <a href="https://cran.r-project.org/package=ncdf4"><code>ncdf4</code></a> package, or <code>RasterLayer</code> of the <a href="https://cran.r-project.org/package=raster"><code>raster</code></a> package.</p>
<div id="data_import_note" class="section level3">
<h3 class="hasAnchor">
<a href="#data_import_note" class="anchor"></a>Important note regarding the import of the data in R</h3>
<p>In any case, care must be taken when importing data that was downloaded through the OPeNDAP data providers servers. Depending on the collection, some “issues” were raised. These issues are independant from modisfast : they result most of time of a kind of lack of full implementation of the OPeNDAP framework by the data providers. These issues are :</p>
<ul>
<li>for MODIS and VIIRS collections : CRS has to be provided</li>
<li>for GPM collections : CRS has to be provided + data have to be flipped</li>
<li>for SMAP collections : CRS + bounding coordinates of the data have to be provided</li>
</ul>
<p>These issues can easily be dealt at the import phase in R. Below we propose some functions that include the processings that have to be done at the data import phase in order to open the data as <code>raster</code> objects. (argument <code>destfiles</code> is the path to a dataset downloaded with modisfast - output of <code>mf_get_url()$destfile</code> - and <code>variable</code> is the name of a variable to import).</p>
</div>
<div id="functions-to-import-the-data-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-to-import-the-data-in-r" class="anchor"></a>Functions to import the data in R</h3>
<div id="import-modis-vnp" class="section level4">
<h4 class="hasAnchor">
<a href="#import-modis-vnp" class="anchor"></a>Import MODIS / VIIRS</h4>
<p>As a <code>RasterLayer</code> object :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">## Functions to import MODIS and VIIRS products as RasterLayer object</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># In case the ROI covers one single MODIS tile :</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(raster)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">.import_modis_onetile &lt;-<span class="st"> </span><span class="cf">function</span>(destfiles,variable){</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  rasts &lt;-<span class="st"> </span>destfiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">    </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>(.,<span class="dt">varname=</span>variable,<span class="dt">crs=</span><span class="st">"+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs"</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(rasts)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co"># In case the ROI covers multiple MODIS tiles :</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11">.import_modis_moretiles &lt;-<span class="st"> </span><span class="cf">function</span>(destfiles,variable){</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">  rasts &lt;-<span class="st"> </span>destfiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">    </span>purrr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(<span class="op">~</span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>(.,<span class="dt">varname=</span>variable,<span class="dt">crs=</span><span class="st">"+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/do.call">do.call</a></span>(merge,.)</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(rasts)</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">}</a></code></pre></div>
<p>As a <code>stars</code> object :</p>
<p>We can also import the same MODIS time series as a <code>stars</code> object. Here the interesting point is that all the dimensions are imported at once.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">## Functions to import MODIS and VIIRS products as stars object</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">.import_modis_stars &lt;-<span class="st"> </span><span class="cf">function</span>(destfiles){</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  stars &lt;-<span class="st"> </span>stars<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stars/topics/read_stars">read_stars</a></span>(destfiles) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_crs">st_set_crs</a></span>(<span class="st">"+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs"</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(stars)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co"># plot(mod11a1_stars)</span></a></code></pre></div>
</div>
<div id="import-gpm" class="section level4">
<h4 class="hasAnchor">
<a href="#import-gpm" class="anchor"></a>Import GPM</h4>
<p>As a <code>RasterLayer</code> object :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">## Function to import GPM products as RasterLayer object</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(purrr)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">.import_gpm &lt;-<span class="st"> </span><span class="cf">function</span>(destfiles,variable){</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  rasts &lt;-<span class="st"> </span>destfiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">    </span>purrr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(<span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(., <span class="dt">varname =</span> variable,<span class="dt">crs =</span> <span class="st">"+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 "</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">    </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">    </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/transpose">t</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">    </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/flip">flip</a></span>(<span class="st">"y"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">    </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/flip">flip</a></span>(<span class="st">"x"</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(rasts)</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">}</a></code></pre></div>
</div>
<div id="import-smap" class="section level4">
<h4 class="hasAnchor">
<a href="#import-smap" class="anchor"></a>Import SMAP</h4>
<p>As a <code>RasterLayer</code> object :</p>
<p>We set-up the missing bounding coordinates. For this we use the function <code><a href="../reference/mf_get_opt_param.html">mf_get_opt_param()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">## Function to import SMAP products as RasterLayer object</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(purrr)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(ncdf4)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(raster)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">smap_sp_bound &lt;-<span class="st"> </span>modisfast<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/modisfast/topics/mf_get_opt_param">mf_get_opt_param</a></span>(<span class="dt">roi =</span> roi, <span class="dt">collection =</span> <span class="st">"SPL3SMP_E.003"</span>)<span class="op">$</span>roiSpatialBound<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">.import_smap &lt;-<span class="st"> </span><span class="cf">function</span>(destfiles,variable,smap_sp_bound){</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"> rasts &lt;-<span class="st"> </span>destfiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">   </span>purrr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(<span class="op">~</span>ncdf4<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ncdf4/topics/nc_open">nc_open</a></span>(.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">   </span>purrr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(<span class="op">~</span>ncdf4<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ncdf4/topics/ncvar_get">ncvar_get</a></span>(., <span class="st">"Soil_Moisture_Retrieval_Data_AM_soil_moisture"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">   </span>purrr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(<span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/transpose">t</a></span>(.), <span class="dt">ymn=</span>smap_sp_bound[<span class="dv">1</span>], <span class="dt">ymx=</span>smap_sp_bound[<span class="dv">2</span>], <span class="dt">xmn=</span>smap_sp_bound[<span class="dv">3</span>], <span class="dt">xmx=</span>smap_sp_bound[<span class="dv">4</span>], <span class="dt">crs=</span><span class="st">"+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># EPSG : 6933</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">   </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/brick">brick</a></span>()</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(rasts)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">}</a></code></pre></div>
</div>
<div id="import-the-data-from-our-example" class="section level4">
<h4 class="hasAnchor">
<a href="#import-the-data-from-our-example" class="anchor"></a>Import the data from our example</h4>
<p>So let’s import the data from our example, using the functions provided below :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># import MOD11A1.006</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">mod11a1_rast_day &lt;-<span class="st"> </span><span class="kw">.import_modis_onetile</span>(urls_mod11a1<span class="op">$</span>destfile, <span class="st">"LST_Day_1km"</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># import GPM</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">gpm_rast_precipitationcal &lt;-<span class="st"> </span><span class="kw">.import_gpm</span>(urls_gpm<span class="op">$</span>destfile, <span class="st">"precipitationCal"</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># import SPL3SMP_E.003</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">smap_rast_sm_am &lt;-<span class="st"> </span><span class="kw">.import_smap</span>(urls_smap<span class="op">$</span>destfile, <span class="st">"Soil_Moisture_Retrieval_Data_AM_soil_moisture"</span>,smap_sp_bound)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">mod11a1_rast_day</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; class       : RasterBrick </span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; dimensions  : 86, 48, 4128, 30  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; resolution  : 926.6254, 926.6254  (x, y)</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; extent      : -637981.6, -593503.6, 981759.6, 1061449  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; data source : /home/ptaconet/modisfast/vignettes/MOD11A1.006/MOD11A1.006.2017001_2017030.h17v08.nc4 </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; names       : X2017.01.01, X2017.01.02, X2017.01.03, X2017.01.04, X2017.01.05, X2017.01.06, X2017.01.07, X2017.01.08, X2017.01.09, X2017.01.10, X2017.01.11, X2017.01.12, X2017.01.13, X2017.01.14, X2017.01.15, ... </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; Date        : 2017-01-01, 2017-01-30 (min, max)</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; varname     : LST_Day_1km</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18">gpm_rast_precipitationcal</a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; class       : RasterBrick </span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; dimensions  : 8, 5, 40, 30  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; resolution  : 0.1000023, 0.09999956  (x, y)</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; extent      : -5.800004, -5.299993, 8.900002, 9.699998  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; coord. ref. : +init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; data source : in memory</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; names       :     layer.1,     layer.2,     layer.3,     layer.4,     layer.5,     layer.6,     layer.7,     layer.8,     layer.9,    layer.10,    layer.11,    layer.12,    layer.13,    layer.14,    layer.15, ... </span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; min values  : 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.015777921, 0.000000000, 0.021967307, 0.002506131, 0.000000000, 0.000000000, ... </span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; max values  :  0.00000000,  1.00454104,  0.01239155,  0.00000000,  0.00000000,  0.00000000,  0.00000000,  0.02110096,  0.34920487,  0.42241478,  2.99069405,  5.54364347,  0.19833815,  0.21644105,  1.17732072, ...</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28">smap_rast_sm_am</a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt; class       : RasterBrick </span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; dimensions  : 11, 6, 66, 30  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt; resolution  : 7506.713, 8189.135  (x, y)</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt; extent      : -563003.5, -517963.2, 1121503, 1211583  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="co">#&gt; coord. ref. : +proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="co">#&gt; data source : in memory</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="co">#&gt; names       :    layer.1,    layer.2,    layer.3,    layer.4,    layer.5,    layer.6,    layer.7,    layer.8,    layer.9,   layer.10,   layer.11,   layer.12,   layer.13,   layer.14,   layer.15, ... </span></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co">#&gt; min values  :         NA, 0.09996461,         NA,         NA, 0.09471568,         NA, 0.05590146,         NA,         NA, 0.09872495,         NA,         NA, 0.09351711,         NA, 0.06066480, ... </span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co">#&gt; max values  :         NA,  0.1452434,         NA,         NA,  0.1560785,         NA,  0.1505869,         NA,         NA,  0.1704942,         NA,         NA,  0.1503100,         NA,  0.1584005, ...</span></a></code></pre></div>
</div>
</div>
</div>
<div id="plot-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-data" class="anchor"></a>Plot the data</h2>
<p>Let’s finally plot the data !</p>
<p>(Note that only the first 16 dates are plotted here-under)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Land surface temperature</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">mod11a1_rast_day &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/projectRaster">projectRaster</a></span>(mod11a1_rast_day,<span class="dt">crs =</span> <span class="st">"+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 "</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(mod11a1_rast_day)</a></code></pre></div>
<p><img src="opendapr1_files/figure-html/plot%20-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Precipitation</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(gpm_rast_precipitationcal) &lt;-<span class="st"> </span>urls_gpm<span class="op">$</span>time_start</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(gpm_rast_precipitationcal)</a></code></pre></div>
<p><img src="opendapr1_files/figure-html/plot%20-2.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Soil moisture</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">smap_rast_sm_am &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/projectRaster">projectRaster</a></span>(smap_rast_sm_am,<span class="dt">crs =</span> <span class="st">"+init=epsg:4326 +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 "</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(smap_rast_sm_am) &lt;-<span class="st"> </span>urls_smap<span class="op">$</span>time_start</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(smap_rast_sm_am)</a></code></pre></div>
<p><img src="opendapr1_files/figure-html/plot%20-3.png" width="864" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#check-which-collections-are-available">Check which collections are available</a></li>
      <li><a href="#setup-the-region-and-time-range-of-interest">Setup the region and time range of interest</a></li>
      <li><a href="#login-to-eosdis-earthdata">Login to EOSDIS Earthdata</a></li>
      <li><a href="#get-url">Get the OPeNDAP URLs of the data to download</a></li>
      <li><a href="#download">Download the data</a></li>
      <li><a href="#import">Import the data in R</a></li>
      <li><a href="#plot-the-data">Plot the data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Paul Taconet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
